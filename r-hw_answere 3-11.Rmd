---
title: "Домашнее задание"
output:
  word_document: default
  pdf_document: default
header-includes:
- \usepackage[russian]{babel}
- \usepackage{hyperref}
- \usepackage{amsmath}
- \hypersetup{colorlinks=true,urlcolor=blue}
---

## Задача 1

В переменной `belki` сохранено число очков у команды «Белки», а в переменной `strelki` сохранено число очков у команды «Стрелки» (создайте переменные и присвойте им значения по своему усмотрению).
Напишите код, который сравнивает значения переменных, а также:	

* если число очков у первой команды больше, чем у второй, выводит на экран сообщение «Победила команда БЕЛКИ!»;	

* если число очков у второй команды больше, чем у первой, выводит на экран сообщение «Победила команда СТРЕЛКИ!»;

* если обе команды набрали одинаковое число очков, выводится сообщение «Победила дружба!».	

*Ответ:*

```{r}
belki <- 48
strelki <- 32

if (belki > strelki){
  print("Победила команда БЕЛКИ!")
} else if (belki < strelki){
  print("Победила команда СТРЕЛКИ!")
} else {
  print("Победила дружба!")
}
```

\newpage
### Задача 2

Дан вектор со значениями температуры воздуха 10 дней февраля:

```{r}
temp <- c(-8, -5, 0, 2, -6, -9, -8, -12, -11, -7)
```

Нормальная температура в феврале лежит в пределах от $-9,8$ до $-3,7^\circ$С.
 							
Напишите код, который выводит на экран температуру воздуха (каждый элемент вектора `temp`) и комментарий к нему:					

* если температура выше нормы, то «Температура выше нормы»; 
* если температура ниже нормы, то «Температура ниже нормы»; 
* если температура в норме, то «Температура в норме».

**Пример вывода на экран.** 2 Температура выше нормы			

*Ответ:*

```{r}
temp <- c(-8, -5, 0, 2, -6, -9, -8, -12, -11, -7)

for (i in temp){
  if (i > -3.7){
    cat(i, "Температура выше нормы.\n") 
  } else if (i < -9.8){
    cat(i, "Температура ниже нормы.\n") 
  } else {
    cat(i, "Температура в норме.\n")
  }
}
```

\newpage
## Задача 3

Напишите функцию `progress()`, которая:

* принимает на вход два числа: число сданных домашних заданий и общее число домашних заданий;				
* возвращает процент выполненных домашних заданий, округлённый до второго знака после запятой. 							

*Ответ:*

```{r}
progress <- function(x, y){
  z <- x * 100 / y
  round(z, 2)
}
progress (3, 27)
```

\newpage
## Задача 4

Напишите функцию `assessment()`, которая:

* принимает на вход вектор прибыли (может содержать как положительные, так и отрицательные значения);
* возвращает вектор такой же длины, что и вектор на входе, из 0 и 1, где 0 соответствует отрицательным и нулевым значениям прибыли, а 1 — положительным значениям прибыли.					

В этой задаче необходимо использовать цикл `for`. 

**Пример**

На входе: `c(-100, 150, 3500, 720, 0, -350)`.

На выходе: `c(0, 1, 1, 1, 1, 0, 0)`.

```{r}
assessment <- function(v){
  for (i in v){
    if (i <= 0){
      v <- replace(v, v == i, 0)
    } else {
      v <- replace(v, v == i, 1)
    }
  }
  v
}

assessment(c(-100, 150, 3500, 720, 0, -350))
```

\newpage
## Задача 5

Решите предыдущую задачу без использования цикла, но с использованием функции `ifelse()`. 

**Подсказка.** Запросите *help* по этой функции и посмотрите, как она работает.	

*Ответ:*

```{r}
v <- c(-100, 150, 3500, 720, 0, -350)
v <- ifelse(v <= 0, 0 , 1)
```

\newpage
## Задача 6
Дан список с адресами (для простоты в списке только улицы):

```{r}
addrs <- list("Адрес: улица Высокая, дом 5", 
            "Адрес: ул. Речников, дом 10",
		"Адрес: Ул. Педагогическая, дом 12", 
		"Адрес: Улица Новая Басманная, дом 9")
```

Используя функции для работы со строками и функции для векторизованных операций, получите список `addrs_new` со строками такого вида (на примере первого адреса):

```
"Ул. Высокая, дом 5"
```

**Примечание.** Если вы знакомы с регулярными выражениями для работы со строками, это замечательно, но их мы будем использовать позже, в рамках обработки данных средствами библиотеки `tidyverse`. В данном задании достаточно использовать функцию `gsub()` для замены. 

*Ответ:*

```{r}
addrs <- list("Адрес: улица Высокая, дом 5", 
              "Адрес: ул. Речников, дом 10",
              "Адрес: Ул. Педагогическая, дом 12", 
              "Адрес: Улица Новая Басманная, дом 9")

all_addrs <- function(s){
  addrs2 <- strsplit(unlist(s), ":")[[1]][2]
  addrs3 <- gsub("улица|Улица", "Ул.", trimws(addrs2))
  addrs3
}

addrs_new <- lapply(addrs, all_addrs)
addrs_new
```

\newpage
## Задача 7
Напишите функцию `my_median()`, которая принимает на вход числовой вектор и возвращает его медиану. Использовать готовые функции R для нахождения медианы и прочих характеристик, например `median()`, `summary()`, `fivenum()`, нельзя.

Медиана выборки (набора чисел) — такое значение, которое 50% значений выборки не превышают.

Существуют различные алгоритмы вычисления медианы, в этом задании предлагается следующий:

1. Упорядочить вектор по возрастанию.
2. Если число элементов нечётное, то медиана — элемент с индексом `(n+1)/2`, где `n` — длина вектора. Если число элементов чётное, то медиана — среднее арифметическое элементов с индексами `n/2` и `n/2 + 1`.

**Пример 1.** Вектор `c(3, 4, 9, 8, 2)`, медиана 4.

**Пример 2.** Вектор `c(6, 7, 2, 0, 9, 3)`, медиана 4,5.

**Подсказка.** Для проверки чётности числа можно использовать оператор %%, который вычисляет остаток от деления одного числа на другое:

```{r}
5 %% 2
```

*Ответ:*

```{r}
my_median <- function(v){
  s <- sort(v)
  if (length(s) %% 2 == 0){
    b <- (s[length(s) / 2] + s[length(s) / 2 + 1]) / 2
    b
  } else {
    a <- s[(length(s)+1) / 2]
    a
  }
}
my_median(c(3, 4, 9, 8, 2)) 
```
