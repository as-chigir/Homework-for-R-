---
title: "Домашнее задание"
output:
  word_document: default
  html_document: default
---

## Задачи 

### Задача 1

Загрузите данные из файла `Cowles.csv` и сохраните их в датафрейм `psy`. 

*Ответ:*

```{r}
setwd("C:/Users/alexandra_c/Desktop/Уроки R/Практические задания/11 Визуализация данных с библиотекой ggplot2/11-07 Практическая работа")

psy <- read.csv("Cowles.csv")
```

\newpage

### Задача 2

Выведите описательные статистики по всем столбцам датафрейма `psy`. Проинтерпретируйте полученную выдачу.

*Ответ:*

```{r}
summary(psy)
```

\newpage

### Задача 3

Используя библиотеку `ggplot2`, постройте гистограмму для уровня экстраверсии по шкале Айзенка. Сделайте шаг гистограммы равным стандартному отклонению визуализируемого показателя. Измените цвет заливки гистограммы, цвет границ столбцов. Добавьте содержательные подписи по осям и заголовок графика.

Проинтерпретируйте полученный график: сформулируйте, что можно сказать о форме распределения (симметричное, скошенное) и о самых распространённых значениях показателя.

**Подсказка:** стандартное отклонение показателя можно получить с помощью базовой функции `sd()`. 

*Ответ:*

```{r}
library(tidyverse)

ggplot(data = psy, aes(x = extraversion)) +
  geom_histogram(binwidth = sd(psy$extraversion),fill = "yellow", color = "violet") + 
  labs(x = "уровень экстраверсии",
       y = "Частота",
       title = "Уровень экстраверсии по шкале Айзенка")

# если сгладить форму распределения она будет симметричная.
# наибольшая частота у людей со средним значяением уровня экстравертности,
# наименьшая частота у людей с маленьким и наоборот высоким уровнями
```

\newpage


### Задача 4

Используя библиотеку `ggplot2`, постройте графики плотности распределения для уровня невротизма с группировкой по полу респондента. Оба графика должны находиться в пределах одной картинки. Настройте прозрачность графиков, измените цвета заливки. Измените подписи в легенде таким образом, чтобы они были на русском языке.

Проинтерпретируйте полученный график: укажите, у кого в целом уровень невротизма выше, у мужчин или женщин. 

*Ответ:*

```{r}
ggplot(data = psy, aes(x = neuroticism, group = sex, fill = sex)) +
  geom_density(alpha = 0.3) + 
  scale_fill_manual(values = c("thistle", "slategray1"),
                    labels = c("жен", "муж")) +
  theme_bw()

# у женщин уровень невротизма немного выше чем у мужчин
```

\newpage


### Задача 5

Используя библиотеку `ggplot2`, постройте гистограммы для уровня экстраверсии с группировкой по индикатору участия в волонтёрских мероприятиях. Оба графика должны находиться в разных окнах-фасетках в пределах одной картинки. Сделайте шаг гистограмм равным двум. Измените цвета заливки так, чтобы графики были разного цвета. Измените все подписи на графике таким образом, чтобы они были на русском языке.

*Ответ:*

```{r}
labels <- c("no" = "не участвовал", "yes" = "участвовал")

ggplot(data = psy, aes(x = extraversion, fill = volunteer)) +
  geom_density(binwith = 2) + 
  facet_wrap(~volunteer, labeller = as_labeller(labels)) + 
  scale_fill_manual(values = c("yellowgreen", "yellow2"),
                    labels = c("нет", "да")) +
  theme_dark()
```

\newpage

### Задача 6

Используя библиотеку `ggplot2`, постройте столбчатую диаграмму, которая показывает, сколько респондентов мужского и женского пола принимало участие в опросе. Измените цвета заливки столбцов, выбрав цветовую палитру R по своему усмотрению.

Проинтерпретируйте полученный график: укажите, кого больше среди респондентов, мужчин или женщин.

*Ответ:*

```{r}
ggplot(data = psy, aes(x = sex)) +
  geom_bar() +
  scale_fill_brewer(palette = "Pastel2") + 
  theme_classic()

# респондентов женсого пола больше, чем мужского
```

\newpage

### Задача 7

Используя библиотеку `ggplot2`, постройте круговую диаграмму, которая показывает, какая доля респондентов принимает участие в волонтёрских мероприятиях. Измените цвета заливки секторов, выбрав цветовую палитру R по своему усмотрению.

Проинтерпретируйте полученный график: укажите, кого больше среди респондентов, волонтёров или неволонтёров.

*Ответ:*

```{r}
cols <- c('yellow', 'green')

psy_group <- psy %>% group_by(volunteer) %>% tally

ggplot(data = psy_group, aes(x = factor(1), y = n, fill = volunteer)) +
  geom_bar(stat = "Identity", width = 1) +
  coord_polar("y") + 
  scale_fill_manual(values = cols) +
  theme_gray()

# по диаграмме видно, что доля респондентов, НЕ принимающих участие в волонтерских программах, больше
```

\newpage

### Задача 8

Загрузите данные из файла `Crimes.csv` и сохраните их в датафрейм `crimes`. 

*Ответ:*

```{r}
crimes <- read.csv("Crimes.csv")
```

\newpage

### Задача 9

Используя возможности библиотеки `tidyverse`, сохраните в датафрейм `states_an` строки, соответствующие штатам Калифорния, Флорида, Айова (California, Florida, Iowa). 

*Ответ:*

```{r}
states_an <- crimes %>% filter(state == "California" |
                                 state == "Florida" |
                                 state == "Iowa")
```

\newpage

### Задача 10

Используя библиотеку `ggplot2` и данные из датафрейма `states_an`, постройте линейные графики, которые отражают динамику числа краж по годам в штатах Калифорния, Флорида и Айова. Сделайте так, чтобы линии, соответствующие разным штатам, имели разные начертания (сплошная линия, пунктирная линия и так далее).

*Ответ:*

```{r}
ggplot(data = states_an, aes(x = year,
                             y = robbery,
                             color = state,
                             linetype = state,
                             fill = state)) + 
  geom_line(lwd = 2)
```

\newpage

### Задача 11

Используя библиотеку `ggplot2` и данные из датафрейма `crimes`, постройте диаграмму рассеивания, которая отражает связь между числом краж и числом заключённых в тюрьме. 

Проинтерпретируйте полученный график: можно ли считать, что чем больше число заключённых в тюрьмe, тем меньше краж?

*Ответ:*

```{r}
ggplot(data = crimes, aes(x = prisoners,
                             y = robbery)) + 
  geom_point()

# если не брать во внимание рассеинные точки с большими значениями,то можно сделать вывод, что при увеличении числа заключенных количество краж снижается, т.к. форма диаграммы имеет скос вправо.
```

\newpage
